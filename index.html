<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Self-Improvement RPG Dashboard v3</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(to right, #a1c4fd, #c2e9fb);
    display: flex;
    justify-content: center;
    padding: 30px;
    min-height: 100vh;
  }
  .dashboard {
    background: #fff;
    padding: 25px;
    border-radius: 25px;
    width: 600px; /* Thoda zyada space naye sections ke liye */
    box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    display: flex;
    flex-direction: column;
    gap: 20px;
  }
  h2, h3 { text-align: center; color: #004d40; }
  .avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: #ddd url('https://via.placeholder.com/80') center/cover no-repeat;
    margin: 0 auto 15px auto;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    border: 3px solid #00796b;
  }
  .stats, .tasks, .achievements, .avoid-challenge, .history-milestone {
    padding: 15px;
    border-radius: 15px;
    background: #f0f8ff; /* Light background for sections */
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
  }
  .stat {
    margin: 12px 0;
    font-weight: bold;
    color: #333;
  }
  .progress-bar {
    width: 100%;
    background: #e0f2f1; /* Light teal */
    border-radius: 10px;
    overflow: hidden;
    margin-top: 5px;
    border: 1px solid #b2dfdb;
  }
  .progress {
    height: 18px;
    width: 0%;
    background: #00796b; /* Main teal color */
    border-radius: 10px;
    text-align: center;
    color: #fff;
    line-height: 18px;
    transition: width 0.5s ease;
    font-size: 12px;
  }
  #taskInput, #avoidChallengeInput, select {
    width: 50%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
    margin-right: 5px;
  }
  .task-item, .avoid-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 8px 0;
    padding: 10px 15px;
    border-radius: 10px;
    font-size: 14px;
    color: #fff;
    transition: all 0.5s ease;
  }
  .task-item.complete, .avoid-item.strike {
    opacity: 0.5;
    background: #777 !important;
    text-decoration: line-through;
  }
  .category-focus { background: #3f51b5; }
  .category-strength { background: #f44336; }
  .category-mind { background: #9c27b0; }
  .category-skill { background: #ff9800; }
  .category-knowledge { background: #4caf50; }
  .category-health { background: #e91e63; }
  .category-energy { background: #00bcd4; }
  .avoid-item.avoid { background: #c62828; } /* Dark red for avoid */
  .avoid-item.challenge { background: #1565c0; } /* Dark blue for challenge */

  button {
    background: #00796b;
    color: #fff;
    border: none;
    padding: 8px 15px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.2s, transform 0.1s;
    font-weight: 600;
  }
  button:hover { background: #004d40; transform: translateY(-1px); }
  .task-actions { display: flex; gap: 5px; }
  
  .achievements {
    display: flex;
    justify-content: center;
    gap: 15px;
  }
  .badge {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: gold;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    opacity: 0;
    transition: opacity 0.5s ease;
  }
  .badge.show { opacity: 1; }

  /* New sections styling */
  .history-milestone {
    display: flex;
    justify-content: space-between;
    gap: 20px;
  }
  .task-history, .milestones {
    flex: 1;
  }
  .history-item {
    padding: 5px 0;
    border-bottom: 1px dotted #ccc;
    font-size: 13px;
    color: #555;
    display: flex;
    justify-content: space-between;
  }
  .milestone-info {
    font-size: 14px;
    margin-bottom: 8px;
    padding: 5px;
    background: #e1f5fe;
    border-radius: 5px;
  }
  .milestone-info span { font-weight: bold; color: #0288d1; }
  .stat-info {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
  }
</style>
</head>
<body>

<div class="dashboard">
  <div class="avatar"></div>
  <h2>Self-Improvement RPG v3</h2>

  <div class="stats">
    <h3>Stats & Level</h3>
    <div class="stat-info">
      <div>Current Total Level: <span id="level">1</span></div>
      <div>Next Level: <span id="nextLevel">2</span> (XP to Go: <span id="xpToGo">50</span>)</div>
    </div>
    <div class="stat">Focus: <span id="focusVal">0</span> Lv <span id="focusLevel">1</span>
      <div class="progress-bar"><div class="progress" id="focusXP">0%</div></div>
    </div>
    <div class="stat">Strength: <span id="strengthVal">0</span> Lv <span id="strengthLevel">1</span>
      <div class="progress-bar"><div class="progress" id="strengthXP">0%</div></div>
    </div>
    <div class="stat">Mind: <span id="mindVal">0</span> Lv <span id="mindLevel">1</span>
      <div class="progress-bar"><div class="progress" id="mindXP">0%</div></div>
    </div>
    <div class="stat">Skill: <span id="skillVal">0</span> Lv <span id="skillLevel">1</span>
      <div class="progress-bar"><div class="progress" id="skillXP">0%</div></div>
    </div>
    <div class="stat">Knowledge: <span id="knowledgeVal">0</span> Lv <span id="knowledgeLevel">1</span>
      <div class="progress-bar"><div class="progress" id="knowledgeXP">0%</div></div>
    </div>
    <div class="stat">Health: <span id="healthVal">100</span></div>
    <div class="stat">Energy: <span id="energyVal">50</span></div>
  </div>

  <div class="tasks">
    <h3>Daily Quests</h3>
    <input type="text" id="taskInput" placeholder="Add new task (e.g., Study for 1hr)">
    <select id="taskCategory">
      <option value="focus">Focus</option>
      <option value="strength">Strength</option>
      <option value="mind">Mind</option>
      <option value="skill">Skill</option>
      <option value="knowledge">Knowledge</option>
      <option value="health">Health</option>
      <option value="energy">Energy</option>
    </select>
    <button onclick="addTask()">Add Task</button>
    <div id="taskList"></div>
  </div>

  <div class="avoid-challenge">
    <h3>Avoids & Challenges</h3>
    <input type="text" id="avoidChallengeInput" placeholder="e.g., Check phone less than 10 times">
    <select id="avoidChallengeType">
      <option value="avoid">Avoid (Negative Habit)</option>
      <option value="challenge">Challenge (Streak Goal)</option>
    </select>
    <button onclick="addAvoidChallenge()">Add Goal</button>
    <div id="avoidChallengeList"></div>
  </div>
  
  <div class="history-milestone">
    <div class="task-history">
      <h3>Task History</h3>
      <div id="historyList"></div>
    </div>
    <div class="milestones">
      <h3>Milestones</h3>
      <div class="milestone-info">Current: Level <span id="currentMilestone">1</span></div>
      <div class="milestone-info">Next: Level <span id="nextMilestone">10</span></div>
    </div>
  </div>

  <div class="achievements">
    <div id="badgeLevel" class="badge">‚¨ÜÔ∏è</div>
    <div id="badgeTask" class="badge">‚úÖ</div>
    <div id="badgeStreak" class="badge">üî•</div>
  </div>
</div>

<script>
let attributes = {
  focus: { xp:0, level:1 },
  strength: { xp:0, level:1 },
  mind: { xp:0, level:1 },
  skill: { xp:0, level:1 },
  knowledge: { xp:0, level:1 },
  health: { value:100 },
  energy: { value:50 },
};
let completedTasks = 0;
let tasksHistory = [];
let avoidChallenges = [];

// XP needed per level (Level 100 tak ka support)
// Simple model: Level 1: 50 XP, Har level ke baad +20 XP.
function xpNeeded(level){ return 50 + (level-1)*20; }
const MAX_LEVEL = 100;

function updateProgress(){
  let totalLevel = 0;
  let totalXP = 0;
  
  for(let key in attributes){
    if(key==='health'||key==='energy'){
      document.getElementById(key+'Val').textContent = attributes[key].value;
    }else{
      totalLevel += attributes[key].level;
      totalXP += attributes[key].xp + attributes[key].level; // Simplified total XP calculation
      
      document.getElementById(key+'Val').textContent = attributes[key].xp;
      document.getElementById(key+'Level').textContent = attributes[key].level;
      
      let needed = xpNeeded(attributes[key].level);
      let percent = (attributes[key].xp/needed)*100;
      
      const xpBar = document.getElementById(key+'XP');
      xpBar.style.width = percent+'%';
      xpBar.textContent = `${attributes[key].xp}/${needed} XP`;
    }
  }

  // Total Level, Milestones, and XP to Next Level Logic
  document.getElementById('level').textContent = totalLevel;
  
  // Total Level Milestone
  document.getElementById('currentMilestone').textContent = Math.floor(totalLevel/10)*10 || 1;
  document.getElementById('nextMilestone').textContent = Math.ceil(totalLevel/10)*10 + (totalLevel % 10 === 0 && totalLevel !== 0 ? 10 : 0);
  if(totalLevel >= MAX_LEVEL*5) document.getElementById('nextMilestone').textContent = 'MAX!';

  // Total XP/Level for a "Total Level" feel (Simplified for display)
  let avgLevel = Math.round(totalLevel / 5);
  let xpNeededForNextLevel = xpNeeded(avgLevel) * 5; // Approximation
  let currentXP = totalLevel; // Placeholder for total XP
  document.getElementById('nextLevel').textContent = avgLevel + 1 > MAX_LEVEL ? MAX_LEVEL : avgLevel + 1;
  document.getElementById('xpToGo').textContent = 'N/A'; // For simplicity, rely on attribute XP
}

// --- Task Functions ---
function addTask(){
  const taskInput = document.getElementById('taskInput');
  const categorySelect = document.getElementById('taskCategory');
  const taskText = taskInput.value.trim();
  if(taskText==='') return;

  const taskList = document.getElementById('taskList');
  const taskDiv = document.createElement('div');
  taskDiv.className = `task-item category-${categorySelect.value}`;
  taskDiv.innerHTML = `<span>${taskText}</span> <button onclick="completeTask(this,'${categorySelect.value}','${taskText}')">Complete</button>`;

  taskList.appendChild(taskDiv);
  taskInput.value='';
}

function completeTask(button, category, taskText){
  const taskDiv = button.parentElement;
  taskDiv.classList.add('complete');
  setTimeout(()=>taskDiv.remove(),500);

  // XP / Attribute Points Logic
  let xpGain = 10;
  if(category==='health'||category==='energy'){
    attributes[category].value += category==='health'?5:3;
    if(attributes[category].value>100) attributes[category].value=100;
  }else{
    attributes[category].xp += xpGain;
    if(attributes[category].level < MAX_LEVEL && attributes[category].xp>=xpNeeded(attributes[category].level)){
      attributes[category].level++;
      attributes[category].xp -= xpNeeded(attributes[category].level-1);
      showBadge('badgeLevel');
      alert(`${category.charAt(0).toUpperCase()+category.slice(1)} leveled up to Lv ${attributes[category].level}! üéâ`);
    }
  }
  
  // Task History Update
  tasksHistory.unshift({text: taskText, category: category, xp: xpGain, date: new Date().toLocaleDateString()});
  if (tasksHistory.length > 10) tasksHistory.pop(); // Keep history list clean
  updateHistory();


  completedTasks++;
  if(completedTasks %5===0) showBadge('badgeTask');

  updateProgress();
}

function updateHistory(){
  const historyList = document.getElementById('historyList');
  historyList.innerHTML = '';
  tasksHistory.forEach(item => {
    const historyDiv = document.createElement('div');
    historyDiv.className = 'history-item';
    historyDiv.innerHTML = `<span>[+${item.xp} XP] ${item.text}</span> <span>${item.date}</span>`;
    historyList.appendChild(historyDiv);
  });
}

// --- Avoid/Challenge Functions ---
function addAvoidChallenge(){
  const input = document.getElementById('avoidChallengeInput');
  const typeSelect = document.getElementById('avoidChallengeType');
  const goalText = input.value.trim();
  if(goalText==='') return;
  
  const newGoal = {
    text: goalText,
    type: typeSelect.value, // 'avoid' or 'challenge'
    strikes: 0,
    streak: 0, // for challenges
    isFailed: false,
    id: Date.now()
  };
  avoidChallenges.push(newGoal);
  
  renderAvoidChallenges();
  input.value='';
}

function renderAvoidChallenges(){
  const list = document.getElementById('avoidChallengeList');
  list.innerHTML = '';
  
  avoidChallenges.forEach(goal => {
    const goalDiv = document.createElement('div');
    goalDiv.className = `avoid-item ${goal.type} ${goal.isFailed ? 'strike' : ''}`;
    
    let actions = '';
    let statusText = '';
    
    if (goal.type === 'avoid') {
      statusText = `Strikes: ${goal.strikes}`;
      actions = `<button onclick="addStrike(${goal.id})">Fail/Strike</button>`;
      
    } else { // 'challenge'
      statusText = `Streak: ${goal.streak} Days`;
      actions = `
        <button onclick="successChallenge(${goal.id})">Success/Day</button>
        <button onclick="failChallenge(${goal.id})">Fail/Reset</button>
      `;
    }
    
    goalDiv.innerHTML = `
      <span>${goal.text} (${statusText})</span>
      <div class="task-actions">${actions}</div>
    `;
    
    list.appendChild(goalDiv);
  });
}

function addStrike(id){
  const goal = avoidChallenges.find(g => g.id === id);
  if(!goal || goal.type !== 'avoid') return;
  
  goal.strikes++;
  
  // Penalties
  attributes.focus.xp = Math.max(0, attributes.focus.xp - 5);
  attributes.energy.value = Math.max(0, attributes.energy.value - 5);
  
  if(goal.strikes >= 3){
    goal.isFailed = true;
    alert(`AVOID FAILED: ${goal.text} - Too many strikes!`);
    // Remove the goal after failure, or keep it to be deleted manually
    // avoidChallenges = avoidChallenges.filter(g => g.id !== id);
  }
  
  updateProgress();
  renderAvoidChallenges();
}

function successChallenge(id){
  const goal = avoidChallenges.find(g => g.id === id);
  if(!goal || goal.type !== 'challenge') return;
  
  goal.streak++;
  attributes.mind.xp += 15; // Extra XP for success!
  
  if(goal.streak % 7 === 0){
    showBadge('badgeStreak');
    attributes.skill.xp += 20; // Bonus XP for weekly streak!
    alert(`CHALLENGE BONUS! 7-Day Streak for ${goal.text}! +20 Skill XP! üî•`);
  }
  
  updateProgress();
  renderAvoidChallenges();
}

function failChallenge(id){
  const goal = avoidChallenges.find(g => g.id === id);
  if(!goal || goal.type !== 'challenge') return;
  
  if (goal.streak > 0) {
      alert(`CHALLENGE FAILED: ${goal.text} - Streak reset from ${goal.streak}.`);
  }
  
  goal.streak = 0;
  
  updateProgress();
  renderAvoidChallenges();
}

function showBadge(id){
  const badge = document.getElementById(id);
  badge.classList.add('show');
  setTimeout(()=> badge.classList.remove('show'),2000);
}

// Initialize
updateProgress();
renderAvoidChallenges();
</script>

</body>
</html>